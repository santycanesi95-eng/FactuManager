<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FactuManager Pro - Sistema de Facturaci√≥n</title>
    
    <!-- Librer√≠a para generar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Vinculaci√≥n con el archivo CSS -->
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
    <div class="container">
        <!-- ENCABEZADO -->
        <header>
            <h1>üìä FactuManager Pro</h1>
            <p>Sistema de Gesti√≥n de Facturaci√≥n y Control de Stock</p>
            <div class="header-actions">
                <button class="btn-header" onclick="exportarDatos()">üì• Exportar Backup</button>
                <button class="btn-header" onclick="document.getElementById('importFile').click()">üì§ Importar Backup</button>
                <button class="btn-header btn-danger-header" onclick="limpiarTodosLosDatos()">üóëÔ∏è Limpiar Todo</button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importarDatos(event)">
            </div>
        </header>

        <!-- PESTA√ëAS DE NAVEGACI√ìN -->
        <div class="tabs">
            <button class="tab active" onclick="openTab('productos')">üì¶ Productos</button>
            <button class="tab" onclick="openTab('ventas')">üõí Ventas</button>
            <button class="tab" onclick="openTab('compras')">üì• Compras</button>
            <button class="tab" onclick="openTab('informes')">üìÑ Informes</button>
            <button class="tab" onclick="openTab('configuracion')">‚öôÔ∏è Configuraci√≥n</button>
        </div>

        <!-- CONTENIDO PRINCIPAL -->
        <div class="content">
            
            <!-- ========================================== -->
            <!-- TAB 1: GESTI√ìN DE PRODUCTOS -->
            <!-- ========================================== -->
            <div id="productos" class="tab-content active">
                
                <!-- Formulario para agregar/editar productos -->
                <div class="form-section">
                    <h3 id="tituloFormProducto">‚ûï Agregar Nuevo Producto</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nombre del Producto *</label>
                            <input type="text" id="nombreProducto" placeholder="Ej: Maple de Huevos">
                        </div>
                        <div class="form-group">
                            <label>Stock Inicial</label>
                            <input type="number" id="stockInicial" placeholder="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>Stock Actual</label>
                            <input type="number" id="stockActual" placeholder="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>Precio de Costo ($) *</label>
                            <input type="number" id="precioCosto" placeholder="0.00" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label>Precio de Venta ($) *</label>
                            <input type="number" id="precioVentaProducto" placeholder="0.00" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label>Stock M√≠nimo (Alerta)</label>
                            <input type="number" id="stockMinimo" placeholder="5" min="0">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="agregarProducto()" id="btnGuardarProducto">üíæ Guardar Producto</button>
                        <button class="btn btn-secondary" onclick="cancelarEdicionProducto()" id="btnCancelarProducto" style="display: none;">‚ùå Cancelar</button>
                    </div>
                </div>

                <!-- √Årea para mostrar alertas -->
                <div id="alertProducto"></div>

                <!-- Barra de b√∫squeda -->
                <div class="search-section">
                    <input type="text" id="buscarProducto" placeholder="üîç Buscar producto por nombre..." onkeyup="buscarProductos()">
                </div>

                <!-- Tarjetas de estad√≠sticas -->
                <div class="stats">
                    <div class="stat-card">
                        <h4>Total Unidades</h4>
                        <div class="value" id="totalUnidades">0</div>
                    </div>
                    <div class="stat-card">
                        <h4>Productos Registrados</h4>
                        <div class="value" id="cantidadProductos">0</div>
                    </div>
                    <div class="stat-card stat-card-warning">
                        <h4>‚ö†Ô∏è Stock Bajo</h4>
                        <div class="value" id="alertasStock">0</div>
                    </div>
                </div>

                <!-- Tabla de productos -->
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Stock Inicial</th>
                                <th>Stock Actual</th>
                                <th>Stock M√≠n.</th>
                                <th>Precio Costo</th>
                                <th>Precio Venta</th>
                                <th>% Ganancia</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tablaProductos">
                            <tr>
                                <td colspan="8" style="text-align: center; color: #6c757d;">No hay productos registrados</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- TAB 2: VENTAS -->
            <!-- ========================================== -->
            <div id="ventas" class="tab-content">
                
                <!-- Formulario para registrar ventas -->
                <div class="form-section">
                    <h3>üõí Registrar Venta</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Fecha *</label>
                            <input type="date" id="fechaVenta">
                        </div>
                        <div class="form-group">
                            <label>Producto *</label>
                            <select id="productoVenta" onchange="cargarPrecioVenta()">
                                <option value="">Seleccione un producto</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Cantidad *</label>
                            <input type="number" id="cantidadVenta" placeholder="0" min="1" onchange="calcularTotalVenta()">
                        </div>
                        <div class="form-group">
                            <label>Tipo de Pago *</label>
                            <select id="tipoVenta">
                                <option value="efectivo">üíµ Efectivo</option>
                                <option value="transferencia">üí≥ Transferencia</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Precio Unitario ($)</label>
                            <input type="number" id="precioVenta" placeholder="0.00" step="0.01" min="0" readonly style="background: #e9ecef;">
                        </div>
                        <div class="form-group">
                            <label>Total ($)</label>
                            <input type="number" id="totalVenta" placeholder="0.00" step="0.01" readonly style="background: #e9ecef; font-weight: bold; font-size: 1.1em;">
                        </div>
                        <div class="form-group">
                            <label>Cliente/Observaci√≥n</label>
                            <input type="text" id="observacionVenta" placeholder="Opcional">
                        </div>
                    </div>
                    <button class="btn btn-success" onclick="registrarVenta()">üí∞ Registrar Venta</button>
                </div>

                <!-- √Årea para mostrar alertas -->
                <div id="alertVenta"></div>

                <!-- Tarjetas de balance -->
                <div class="stats">
                    <div class="stat-card stat-card-efectivo">
                        <h4>üíµ Ventas Efectivo</h4>
                        <div class="value" id="ventasEfectivo">$0</div>
                    </div>
                    <div class="stat-card stat-card-transferencia">
                        <h4>üí≥ Ventas Transferencia</h4>
                        <div class="value" id="ventasTransferencia">$0</div>
                    </div>
                    <div class="stat-card stat-card-success">
                        <h4>üí∞ Total Ventas</h4>
                        <div class="value" id="totalVentasBalance">$0</div>
                    </div>
                </div>

                <!-- Tabla de ventas -->
                <h3 style="color: #667eea; margin-top: 30px;">Historial de Ventas</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Producto</th>
                                <th>Cantidad</th>
                                <th>Tipo</th>
                                <th>Precio Unit.</th>
                                <th>Total</th>
                                <th>Observaci√≥n</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tablaVentas">
                            <tr>
                                <td colspan="8" style="text-align: center; color: #6c757d;">No hay ventas registradas</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- TAB 3: COMPRAS -->
            <!-- ========================================== -->
            <div id="compras" class="tab-content">
                
                <!-- Formulario para registrar compras -->
                <div class="form-section">
                    <h3>üì• Registrar Compra de Stock</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Fecha *</label>
                            <input type="date" id="fechaCompra">
                        </div>
                        <div class="form-group">
                            <label>Producto *</label>
                            <select id="productoCompra" onchange="cargarPrecioCompra()">
                                <option value="">Seleccione un producto</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Cantidad *</label>
                            <input type="number" id="cantidadCompra" placeholder="0" min="1" onchange="calcularTotalCompra()">
                        </div>
                        <div class="form-group">
                            <label>Tipo de Pago *</label>
                            <select id="tipoCompra">
                                <option value="efectivo">üí∏ Efectivo</option>
                                <option value="transferencia">üè¶ Transferencia</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Precio de Costo ($)</label>
                            <input type="number" id="precioCompra" placeholder="0.00" step="0.01" min="0" readonly style="background: #e9ecef;">
                        </div>
                        <div class="form-group">
                            <label>Total ($)</label>
                            <input type="number" id="totalCompra" placeholder="0.00" step="0.01" readonly style="background: #e9ecef; font-weight: bold; font-size: 1.1em;">
                        </div>
                        <div class="form-group">
                            <label>Proveedor/Observaci√≥n</label>
                            <input type="text" id="observacionCompra" placeholder="Opcional">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="registrarCompra()">üì¶ Registrar Compra</button>
                </div>

                <!-- √Årea para mostrar alertas -->
                <div id="alertCompra"></div>

                <!-- Tarjetas de balance -->
                <div class="stats">
                    <div class="stat-card stat-card-gasto-efectivo">
                        <h4>üí∏ Compras Efectivo</h4>
                        <div class="value" id="comprasEfectivo">$0</div>
                    </div>
                    <div class="stat-card stat-card-gasto-transferencia">
                        <h4>üè¶ Compras Transferencia</h4>
                        <div class="value" id="comprasTransferencia">$0</div>
                    </div>
                    <div class="stat-card stat-card-danger">
                        <h4>üí∏ Total Compras</h4>
                        <div class="value" id="totalComprasBalance">$0</div>
                    </div>
                </div>

                <!-- Tabla de compras -->
                <h3 style="color: #667eea; margin-top: 30px;">Historial de Compras</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Producto</th>
                                <th>Cantidad</th>
                                <th>Tipo</th>
                                <th>Precio Unit.</th>
                                <th>Total</th>
                                <th>Observaci√≥n</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tablaCompras">
                            <tr>
                                <td colspan="8" style="text-align: center; color: #6c757d;">No hay compras registradas</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- TAB 4: INFORMES PDF -->
            <!-- ========================================== -->
            <div id="informes" class="tab-content">
                <div class="form-section">
                    <h3>üìÑ Generar Informe en PDF</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Desde Fecha</label>
                            <input type="date" id="pdfFechaDesde">
                        </div>
                        <div class="form-group">
                            <label>Hasta Fecha</label>
                            <input type="date" id="pdfFechaHasta">
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-success" onclick="generarPDF()">üì• Descargar Informe PDF</button>
                        <p style="color: #6c757d; margin-top: 10px; font-size: 0.9em;">
                            Si no seleccionas fechas, se generar√° un informe completo con todos los datos
                        </p>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">üìä Resumen General</h3>
                    <div class="stats">
                        <div class="stat-card">
                            <h4>Total Productos</h4>
                            <div class="value" id="resumenProductos">0</div>
                        </div>
                        <div class="stat-card stat-card-success">
                            <h4>Total Ventas</h4>
                            <div class="value" id="resumenVentas">0</div>
                        </div>
                        <div class="stat-card stat-card-danger">
                            <h4>Total Compras</h4>
                            <div class="value" id="resumenCompras">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>Balance Total</h4>
                            <div class="value" id="resumenBalance">$0</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- TAB 5: CONFIGURACI√ìN -->
            <!-- ========================================== -->
            <div id="configuracion" class="tab-content">
                <div class="form-section">
                    <h3>‚öôÔ∏è Configuraci√≥n del Sistema</h3>
                    
                    <div class="config-section">
                        <h4>üíæ Gesti√≥n de Datos</h4>
                        <p>Los datos se guardan autom√°ticamente en tu navegador. Puedes hacer backup o limpiar todo.</p>
                        <div style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="exportarDatos()">üì• Exportar Backup (JSON)</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('importFile2').click()">üì§ Importar Backup</button>
                            <button class="btn btn-danger" onclick="limpiarTodosLosDatos()">üóëÔ∏è Limpiar Todos los Datos</button>
                            <input type="file" id="importFile2" accept=".json" style="display: none;" onchange="importarDatos(event)">
                        </div>
                    </div>

                    <div class="config-section">
                        <h4>üìä Estad√≠sticas del Sistema</h4>
                        <div class="stats-info">
                            <div class="stat-info-item">
                                <span class="stat-label">Total de Productos:</span>
                                <span class="stat-value" id="configTotalProductos">0</span>
                            </div>
                            <div class="stat-info-item">
                                <span class="stat-label">Total de Ventas:</span>
                                <span class="stat-value" id="configTotalVentas">0</span>
                            </div>
                            <div class="stat-info-item">
                                <span class="stat-label">Total de Compras:</span>
                                <span class="stat-value" id="configTotalCompras">0</span>
                            </div>
                            <div class="stat-info-item">
                                <span class="stat-label">√öltima actualizaci√≥n:</span>
                                <span class="stat-value" id="configUltimaActualizacion">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h4>‚ÑπÔ∏è Informaci√≥n</h4>
                        <p><strong>FactuManager Pro v4.0</strong></p>
                        <p style="margin-top: 10px; color: #6c757d; line-height: 1.6;">
                            Sistema de gesti√≥n de facturaci√≥n con ventas y compras autom√°ticas.
                            Control diferenciado de efectivo y transferencias.
                        </p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Vinculaci√≥n con el archivo JavaScript -->
    <script src="script.js"></script>
</body>
</html>
