<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FactuManager Pro - Sistema de Facturaci√≥n</title>
    
    <!-- Librer√≠a para generar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Vinculaci√≥n con el archivo CSS -->
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
    <div class="container">
        <!-- ENCABEZADO -->
        <header>
            <h1>üìä FactuManager Pro</h1>
            <p>Sistema de Gesti√≥n de Facturaci√≥n y Control de Stock</p>
            <div class="header-actions">
                <button class="btn-header" onclick="exportarDatos()">üì• Exportar Backup</button>
                <button class="btn-header" onclick="document.getElementById('importFile').click()">üì§ Importar Backup</button>
                <button class="btn-header btn-danger-header" onclick="limpiarTodosLosDatos()">üóëÔ∏è Limpiar Todo</button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importarDatos(event)">
            </div>
        </header>

        <!-- PESTA√ëAS DE NAVEGACI√ìN -->
        <div class="tabs">
            <button class="tab active" onclick="openTab('productos')">üì¶ Productos</button>
            <button class="tab" onclick="openTab('movimientos')">üí∞ Movimientos</button>
            <button class="tab" onclick="openTab('informes')">üìÑ Informes</button>
            <button class="tab" onclick="openTab('configuracion')">‚öôÔ∏è Configuraci√≥n</button>
        </div>

        <!-- CONTENIDO PRINCIPAL -->
        <div class="content">
            
            <!-- ========================================== -->
            <!-- TAB 1: GESTI√ìN DE PRODUCTOS -->
            <!-- ========================================== -->
            <div id="productos" class="tab-content active">
                
                <!-- Formulario para agregar/editar productos -->
                <div class="form-section">
                    <h3 id="tituloFormProducto">‚ûï Agregar Nuevo Producto</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nombre del Producto *</label>
                            <input type="text" id="nombreProducto" placeholder="Ej: Zapatillas Nike">
                        </div>
                        <div class="form-group">
                            <label>Stock Inicial</label>
                            <input type="number" id="stockInicial" placeholder="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>Stock Actual</label>
                            <input type="number" id="stockActual" placeholder="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>Precio de Costo ($) *</label>
                            <input type="number" id="precioCosto" placeholder="0.00" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label>Precio de Venta ($) *</label>
                            <input type="number" id="precioVenta" placeholder="0.00" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label>Stock M√≠nimo (Alerta)</label>
                            <input type="number" id="stockMinimo" placeholder="5" min="0">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="agregarProducto()" id="btnGuardarProducto">üíæ Guardar Producto</button>
                        <button class="btn btn-secondary" onclick="cancelarEdicionProducto()" id="btnCancelarProducto" style="display: none;">‚ùå Cancelar</button>
                    </div>
                </div>

                <!-- √Årea para mostrar alertas -->
                <div id="alertProducto"></div>

                <!-- Barra de b√∫squeda -->
                <div class="search-section">
                    <input type="text" id="buscarProducto" placeholder="üîç Buscar producto por nombre..." onkeyup="buscarProductos()">
                </div>

                <!-- Tarjetas de estad√≠sticas -->
                <div class="stats">
                    <div class="stat-card">
                        <h4>Total Unidades</h4>
                        <div class="value" id="totalUnidades">0</div>
                    </div>
                    
                    <div class="stat-card">
                        <h4>Productos Registrados</h4>
                        <div class="value" id="cantidadProductos">0</div>
                    </div>
                    <div class="stat-card stat-card-warning">
                        <h4>‚ö†Ô∏è Stock Bajo</h4>
                        <div class="value" id="alertasStock">0</div>
                    </div>
                </div>

                <!-- Tabla de productos -->
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Stock Inicial</th>
                                <th>Stock Actual</th>
                                <th>Stock M√≠n.</th>
                                <th>Precio Costo</th>
                                <th>Precio Venta</th>
                                <th>% Ganancia</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tablaProductos">
                            <tr>
                                <td colspan="8" style="text-align: center; color: #6c757d;">No hay productos registrados</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- TAB 2: REGISTRO DE MOVIMIENTOS -->
            <!-- ========================================== -->
            <div id="movimientos" class="tab-content">
                
                <!-- Formulario para registrar movimientos -->
                <div class="form-section">
                    <h3 id="tituloFormMovimiento">‚ûï Registrar Movimiento</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Fecha *</label>
                            <input type="date" id="fechaMovimiento">
                        </div>
                        <div class="form-group">
                            <label>Descripci√≥n *</label>
                            <input type="text" id="descripcionMovimiento" placeholder="Ej: Venta de productos">
                        </div>
                        <div class="form-group">
                            <label>Tipo *</label>
                            <select id="tipoMovimiento">
                                <option value="ingreso">üí∞ Ingreso</option>
                                <option value="gasto">üí∏ Gasto</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Monto ($) *</label>
                            <input type="number" id="montoMovimiento" placeholder="0.00" step="0.01" min="0">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="agregarMovimiento()" id="btnGuardarMovimiento">üíæ Guardar Movimiento</button>
                        <button class="btn btn-secondary" onclick="cancelarEdicionMovimiento()" id="btnCancelarMovimiento" style="display: none;">‚ùå Cancelar</button>
                    </div>
                </div>

                <!-- √Årea para mostrar alertas -->
                <div id="alertMovimiento"></div>

                <!-- Filtros -->
                <div class="filter-section">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Filtrar por Tipo</label>
                            <select id="filtroTipo" onchange="filtrarMovimientos()">
                                <option value="todos">Todos</option>
                                <option value="ingreso">Ingresos</option>
                                <option value="gasto">Gastos</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Desde Fecha</label>
                            <input type="date" id="filtroFechaDesde" onchange="filtrarMovimientos()">
                        </div>
                        <div class="form-group">
                            <label>Hasta Fecha</label>
                            <input type="date" id="filtroFechaHasta" onchange="filtrarMovimientos()">
                        </div>
                        <div class="form-group" style="display: flex; align-items: flex-end;">
                            <button class="btn btn-secondary" onclick="limpiarFiltros()">üîÑ Limpiar Filtros</button>
                        </div>
                    </div>
                </div>

                <!-- Tarjetas de estad√≠sticas financieras -->
                <div class="stats">
                    <div class="stat-card stat-card-success">
                        <h4>üí∞ Total Ingresos</h4>
                        <div class="value" id="totalIngresos">$0</div>
                    </div>
                    <div class="stat-card stat-card-danger">
                        <h4>üí∏ Total Gastos</h4>
                        <div class="value" id="totalGastos">$0</div>
                    </div>
                    <div class="stat-card">
                        <h4>üíµ Saldo Actual</h4>
                        <div class="value" id="saldoActual">$0</div>
                    </div>
                </div>

                <!-- Tabla de movimientos -->
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Descripci√≥n</th>
                                <th>Tipo</th>
                                <th>Monto</th>
                                <th>Saldo</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tablaMovimientos">
                            <tr>
                                <td colspan="6" style="text-align: center; color: #6c757d;">No hay movimientos registrados</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- TAB 3: INFORMES PDF -->
            <!-- ========================================== -->
            <div id="informes" class="tab-content">
                <div class="form-section">
                    <h3>üìÑ Generar Informe en PDF</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Desde Fecha</label>
                            <input type="date" id="pdfFechaDesde">
                        </div>
                        <div class="form-group">
                            <label>Hasta Fecha</label>
                            <input type="date" id="pdfFechaHasta">
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-success" onclick="generarPDF()">üì• Descargar Informe PDF</button>
                        <p style="color: #6c757d; margin-top: 10px; font-size: 0.9em;">
                            Si no seleccionas fechas, se generar√° un informe completo con todos los datos
                        </p>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">üìä Resumen General</h3>
                    <div class="stats">
                        <div class="stat-card">
                            <h4>Total Productos</h4>
                            <div class="value" id="resumenProductos">0</div>
                        </div>
                        <div class="stat-card">
                            <h4>Total Movimientos</h4>
                            <div class="value" id="resumenMovimientos">0</div>
                        </div>
                        <div class="stat-card stat-card-success">
                            <h4>Balance Total</h4>
                            <div class="value" id="resumenBalance">$0</div>
                        </div>
                        <div class="stat-card">
                            <h4>Valor Inventario</h4>
                            <div class="value" id="resumenInventario">$0</div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">‚ÑπÔ∏è Contenido del Informe</h3>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <p><strong>El informe PDF incluir√°:</strong></p>
                        <ul style="margin-top: 10px; margin-left: 20px; color: #6c757d; line-height: 1.8;">
                            <li>üìÖ Fecha de generaci√≥n y rango seleccionado</li>
                            <li>üì¶ Tabla completa de productos con stock y precios</li>
                            <li>üìä Estad√≠sticas generales de productos</li>
                            <li>üí∞ Tabla de movimientos (ingresos y gastos)</li>
                            <li>üíµ Resumen financiero con totales y balance</li>
                            <li>‚ö†Ô∏è Alertas de productos con stock bajo</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- TAB 4: CONFIGURACI√ìN -->
            <!-- ========================================== -->
            <div id="configuracion" class="tab-content">
                <div class="form-section">
                    <h3>‚öôÔ∏è Configuraci√≥n del Sistema</h3>
                    
                    <div class="config-section">
                        <h4>üíæ Gesti√≥n de Datos</h4>
                        <p>Los datos se guardan autom√°ticamente en tu navegador. Puedes hacer backup o limpiar todo.</p>
                        <div style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="exportarDatos()">üì• Exportar Backup (JSON)</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('importFile2').click()">üì§ Importar Backup</button>
                            <button class="btn btn-danger" onclick="limpiarTodosLosDatos()">üóëÔ∏è Limpiar Todos los Datos</button>
                            <input type="file" id="importFile2" accept=".json" style="display: none;" onchange="importarDatos(event)">
                        </div>
                    </div>

                    <div class="config-section">
                        <h4>üìä Estad√≠sticas del Sistema</h4>
                        <div class="stats-info">
                            <div class="stat-info-item">
                                <span class="stat-label">Total de Productos:</span>
                                <span class="stat-value" id="configTotalProductos">0</span>
                            </div>
                            <div class="stat-info-item">
                                <span class="stat-label">Total de Movimientos:</span>
                                <span class="stat-value" id="configTotalMovimientos">0</span>
                            </div>
                            <div class="stat-info-item">
                                <span class="stat-label">√öltima actualizaci√≥n:</span>
                                <span class="stat-value" id="configUltimaActualizacion">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h4>‚ÑπÔ∏è Informaci√≥n</h4>
                        <p><strong>FactuManager Pro v2.0</strong></p>
                        <p style="margin-top: 10px; color: #6c757d; line-height: 1.6;">
                            Sistema de gesti√≥n de facturaci√≥n y control de stock con persistencia de datos.
                            Todas las funcionalidades est√°n disponibles sin necesidad de conexi√≥n a internet.
                        </p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Vinculaci√≥n con el archivo JavaScript -->
    <script src="script.js"></script>
</body>
</html>